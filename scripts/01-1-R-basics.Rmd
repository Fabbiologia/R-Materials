---
title: "R-basics"
author: "Fabio Favoretto"
date: "`r Sys.Date()`"
output: 
        ioslides_presentation:
                logo: "figs/cropped-rstudio.png"
                widescreen: true
                incremental: true
---
# Why R is cool?

## Animated graphs
```{r echo=FALSE, message=FALSE, warning=FALSE, out.width='80%'}
library(gapminder)
library(ggplot2)
library(gganimate)
ggplot(gapminder, aes(gdpPercap, lifeExp, size = pop, colour = country)) +
  geom_point(alpha = 0.7, show.legend = FALSE) +
  scale_colour_manual(values = country_colors) +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  facet_wrap(~continent) +
  # Here comes the gganimate specific bits
  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +
  transition_time(year) +
  ease_aes('linear')
```

## Animated graphs
```{r echo=FALSE, message=FALSE, warning=FALSE, out.width='60%'}

knitr::include_graphics('figs/MictScarLutj.gif')

```



## Interactive graphs
```{r echo=FALSE, fig.align='center', message=FALSE, warning=FALSE}
# Charge the plotly library
library(plotly)
 
# Let's use the diamonds data set :
d <- diamonds[sample(nrow(diamonds), 1000), ]
 
# Make a basic scatter plot :
p=plot_ly(d, x = ~carat, y = ~price, type="scatter", text = paste("Clarity: ", d$clarity),
        mode = "markers", color = ~carat, size = ~carat)
p
```

## Interactive graphs

```{r echo=FALSE, fig.align='center'}
library(plotly)
 
# A basic boxplot
library(plotly)
p <- plot_ly(midwest, x = ~percollege, color = ~state, type = "box")
p
```

## Interactive graphs

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Plotly library
library(plotly)

# 3D plot :
p=plot_ly(z = volcano, type = "surface")
p
```



## Crazy stuff...

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
library(CatterPlots)
x <- -10:10
y <- -x^2 + 10
# random cats
meow <- multicat(xs=x, ys=rnorm(21),
                 cat=c(1,2,3,4,5,6,7,8,9,10),
                 catcolor="black",
                 canvas=c(-0.1,1.1, -0.1, 1.1),
                 xlab="some cats", ylab="other cats", main="Random Cats")

```

# Reproducible science

## {data-background=figs/rdiag.png}

## Data science | Flow chart

<div class="centered">
![](figs/R-Flowchart.jpg)
</div>

## The data pipeline

<div class="centered">
![](figs/data-pipeline.jpg)
</div>


# {data-background=figs/repcode.jpg}

## How to prepare a working directory
<div class="columns-2">

  ![](figs/folderstructure.jpg)
  
- `data` folder contains all input data (and metadata) used in the analysis; 
- The `doc` folder contains the manuscript;
- The `figs` directory contains figures generated by the analysis;
- The `output` folder contains any type of intermediate or output files;
- The R directory contains R scripts with function definitions;
- The `reports` folder contains RMarkdown files that document the analysis or
report on results;

</div>

## File names and type of data files
![](figs/filenames.jpg)

## File paths

```{r, eval=FALSE}
# Absolute path ------------------------------
"C:/Users/zephi/Dropbox/R-crash-course/figs/cropped-rstudio.png"

# Relative path ------------------------------
"figs/cropped-rstudio.png"
```

# [The R studio IDE](cheatsheets/rstudio-ide.pdf)

## Exercise
- create data; 
- organize folder; 
- create R-project; 
- load data into R;


## Reading and writing data

[cheatsheet](cheatsheets/data-import.pdf)
```{r}
# Load data into R from excel
library(readxl)
df <- read_xlsx("data/fishing_effort.xlsx")
```



## Scripting
- Start your analysis from copies of your raw data;
- Any cleaning, merging, transforming, etc. of data should be done in scripts,
not manually;
- Split your workflow (scripts) into logical thematic units;
- Eliminate code duplication by using functions;
- Document your code and data;
- Keep intermediary outputs separate from raw data;

# R-packages and GitHub


## Ask for help
```{r echo=FALSE, fig.align='center', message=FALSE, warning=FALSE, out.width="80%"}
library(knitr)
include_graphics(path = "figs/help-me-help-you.gif") 
```

## Useful help
- Google/StackOverflow
- R community on twitter
- GitHub

## How to ask for help

- Google extensively... 
- You **will not** get an answer if you duplicate questions (geeks know everything)
- There is nothing more disrespectful than being lazy
- 9 times out of 10 someone already had the same or similar problem as you
- "reproducible example" (reprex) 
- You **will not** get an answer without a `reprex`. 

## Further reading

[seeking help](https://swcarpentry.github.io/r-novice-gapminder/03-seeking-help/index.html)


